# 基于PaddlePaddle2.0的蝴蝶图像识别分类——利用预训练残差网络ResNet101模型

作者：陆平




```python
!cd data &&\
unzip -qo data63004/Butterfly20_test.zip &&\
unzip -qo data63004/Butterfly20.zip &&\
rm -r __MACOSX
```


```python
import os
import random

import cv2
import numpy as np
from matplotlib import pyplot as plt
```


```python
#以下代码用于建立样本数据读取路径与样本标签之间的关系



data_list = [] #用个列表保存每个样本的读取路径、标签

#由于属种名称本身是字符串，而输入模型的是数字。需要构造一个字典，把某个数字代表该属种名称。键是属种名称，值是整数。
label_list=[]
with open("/home/aistudio/data/species.txt") as f:
    for line in f:
        a,b = line.strip("\n").split(" ")
        label_list.append([b, int(a)-1])
label_dic = dict(label_list)
# print(label_dic)

#获取Butterfly20目录下的所有子目录名称，保存进一个列表之中
class_list = os.listdir("/home/aistudio/data/Butterfly20")
class_list.remove('.DS_Store') #删掉列表中名为.DS_Store的元素，因为.DS_Store并没有样本。
# print(class_list)

for each in class_list:
    #print(each)
    for f in os.listdir("/home/aistudio/data/Butterfly20/"+each):
        #print(f)
        filename = "/home/aistudio/data/Butterfly20/"+each+'/'+f
        img = cv2.imread(filename)
        dst = cv2.flip(img,1)  #水平翻转图片
        #plt.imshow(dst)
        cv2.imwrite("/home/aistudio/data/Butterfly20/"+each+'/new_'+f, dst) #将翻转的图片加入数据集

```


```python
for each in class_list:
    for f in os.listdir("/home/aistudio/data/Butterfly20/"+each):# each 是 子文件夹名，蝴蝶类
        data_list.append(["/home/aistudio/data/Butterfly20/"+each+'/'+f,label_dic[each]])# f 是 子文件夹里面每张图片名，具体蝴蝶图像名

#按文件顺序读取，可能造成很多属种图片存在序列相关，用random.shuffle方法把样本顺序彻底打乱。
random.shuffle(data_list)

#打印前十个，可以看出data_list列表中的每个元素是[样本读取路径, 样本标签]。
# print(data_list[0:10])

#打印样本数量
print("样本数量是：{}".format(len(data_list)))
```

    样本数量是：3732



```python
#以下代码用于构造读取器与数据预处理
#首先需要导入相关的模块
import paddle
from paddle.vision.transforms import Compose, ColorJitter, Resize,Transpose, Normalize,ColorJitter
import cv2
import numpy as np
from PIL import Image
from paddle.io import Dataset
import paddle.vision.transforms as T
#自定义的数据预处理函数，输入原始图像，输出处理后的图像，可以借用paddle.vision.transforms的数据处理功能
def preprocess(img):
    transform = Compose([
        Resize(size=(224, 224)), #把数据长宽像素调成224*224
        T.ColorJitter(0.125,0.4,0.4,0.08),                                                   # 保持亮度、对比度、饱和度、色调等在测试集上一致
        # T.BrightnessTransform(0.4),                                                        # 只对亮度调整做调整
        T.RandomHorizontalFlip(224),                                                         # 水平翻转
        T.RandomRotation(90),                                                                # 随机反转角度范围
        T.RandomVerticalFlip(224),                                                           # 垂直翻转
        T.RandomRotation(90),        
        Normalize(mean=[0,0,0], std=[255, 255, 255], data_format='HWC'), #标准化
        Transpose(), #原始数据形状维度是HWC格式，经过Transpose，转换为CHW格式
        ])
    img = transform(img).astype("float32")
    return img

#自定义数据读取器
class Reader(Dataset):
    def __init__(self, data, is_val=False):
        super().__init__()
        #在初始化阶段，把数据集划分训练集和测试集。由于在读取前样本已经被打乱顺序，取20%的样本作为测试集，80%的样本作为训练集。
        self.samples = data[-int(len(data)*0.2):] if is_val else data[:-int(len(data)*0.2)]

    def __getitem__(self, idx):
        #处理图像
        img_path = self.samples[idx][0] #得到某样本的路径
        img = Image.open(img_path)
        if img.mode != 'RGB':
            img = img.convert('RGB')
        img = preprocess(img) #数据预处理--这里仅包括简单数据预处理，没有用到数据增强

        #处理标签
        label = self.samples[idx][1] #得到某样本的标签
        label = np.array([label], dtype="int64") #把标签数据类型转成int64
        return img, label

    def __len__(self):
        #返回每个Epoch中图片数量
        return len(self.samples)

#生成训练数据集实例
train_dataset = Reader(data_list, is_val=False)

#生成测试数据集实例
eval_dataset = Reader(data_list, is_val=True)

#打印一个训练样本
#print(train_dataset[1136][0])
print(train_dataset[1136][0].shape)
print(train_dataset[1136][1])

```

    (3, 224, 224)
    [2]


## 5. 建立模型

为了提升探索速度，建议首先选用比较成熟的基础模型，看看基础模型所能够达到的准确度。之后再试试模型融合，准确度是否有提升。最后可以试试自己独创模型。

为简便，这里直接采用101层的残差网络ResNet，并且采用预训练模式。为什么要采用预训练模型呢？因为通常模型参数采用随机初始化，而预训练模型参数初始值是一个比较确定的值。这个参数初始值是经历了大量任务训练而得来的，比如用CIFAR图像识别任务来训练模型，得到的参数。虽然蝴蝶识别任务和CIFAR图像识别任务是不同的，但可能存在某些机器视觉上的共性。用预训练模型可能能够较快地得到比较好的准确度。

在PaddlePaddle2.0中，使用预训练模型只需要设定模型参数pretained=True。值得注意的是，预训练模型得出的结果类别是1000维度，要用个线性变换，把类别转化为20维度。


```python
#定义模型
class MyNet(paddle.nn.Layer):
    def __init__(self):
        super(MyNet,self).__init__()
        self.layer=paddle.vision.models.resnet101(pretrained=True)
        self.dropout=paddle.nn.Dropout(p=0.5)
        self.fc = paddle.nn.Linear(1000, 20)
    #网络的前向计算过程
    def forward(self,x):
        x=self.layer(x)
        x=self.dropout(x)
        x=self.fc(x)
        return x
```


```python
#定义输入
input_define = paddle.static.InputSpec(shape=[-1,3,224,224], dtype="float32", name="img")
label_define = paddle.static.InputSpec(shape=[-1,1], dtype="int64", name="label")

#实例化网络对象并定义优化器等训练逻辑
model = MyNet()
model = paddle.Model(model,inputs=input_define,labels=label_define) #用Paddle.Model()对模型进行封装
optimizer = paddle.optimizer.Adam(learning_rate=3e-4, parameters=model.parameters())
#上述优化器中的学习率(learning_rate)参数很重要。要是训练过程中得到的准确率呈震荡状态，忽大忽小，可以试试进一步把学习率调低。

model.prepare(optimizer=optimizer, #指定优化器
              loss=paddle.nn.CrossEntropyLoss(), #指定损失函数
              metrics=paddle.metric.Accuracy()) #指定评估方法


```

    2021-03-10 13:42:46,934 - INFO - unique_endpoints {''}
    2021-03-10 13:42:46,936 - INFO - Downloading resnet101.pdparams from https://paddle-hapi.bj.bcebos.com/models/resnet101.pdparams
    100%|██████████| 263160/263160 [00:03<00:00, 66956.99it/s]
    2021-03-10 13:42:51,169 - INFO - File /home/aistudio/.cache/paddle/hapi/weights/resnet101.pdparams md5 checking...



```python
model.fit(train_data=train_dataset,     #训练数据集
          eval_data=eval_dataset,         #测试数据集
          batch_size=64,                  #一个批次的样本数量
          epochs=10,                      #迭代轮次
          shuffle=True,
          save_dir="/home/aistudio/lup", #把模型参数、优化器参数保存至自定义的文件夹
          save_freq=20,                    #设定每隔多少个epoch保存模型参数及优化器参数
          log_freq=100,
          verbose=1                    #打印日志的频率
)
```

    The loss value printed in the log is the current step, and the metric is the average value of previous step.
    Epoch 1/10


    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/fluid/layers/utils.py:77: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
      return (isinstance(seq, collections.Sequence) and
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/nn/layer/norm.py:648: UserWarning: When training, we now always track global mean and variance.
      "When training, we now always track global mean and variance.")


    step 47/47 [==============================] - loss: 1.2684 - acc: 0.4799 - 976ms/step
    save checkpoint at /home/aistudio/lup/0
    Eval begin...
    The loss value printed in the log is the current batch, and the metric is the average value of previous step.
    step 12/12 [==============================] - loss: 1.1635 - acc: 0.7225 - 851ms/step
    Eval samples: 746
    Epoch 2/10
    step 47/47 [==============================] - loss: 0.5241 - acc: 0.7545 - 972ms/step
    Eval begin...
    The loss value printed in the log is the current batch, and the metric is the average value of previous step.
    step 12/12 [==============================] - loss: 0.7176 - acc: 0.7855 - 877ms/step
    Eval samples: 746
    Epoch 3/10
    step 47/47 [==============================] - loss: 0.5882 - acc: 0.8088 - 982ms/step
    Eval begin...
    The loss value printed in the log is the current batch, and the metric is the average value of previous step.
    step 12/12 [==============================] - loss: 0.8078 - acc: 0.8137 - 884ms/step
    Eval samples: 746
    Epoch 4/10
    step 47/47 [==============================] - loss: 0.4881 - acc: 0.8486 - 976ms/step
    Eval begin...
    The loss value printed in the log is the current batch, and the metric is the average value of previous step.
    step 12/12 [==============================] - loss: 0.6811 - acc: 0.8633 - 877ms/step
    Eval samples: 746
    Epoch 5/10
    step 47/47 [==============================] - loss: 0.2994 - acc: 0.8583 - 985ms/step
    Eval begin...
    The loss value printed in the log is the current batch, and the metric is the average value of previous step.
    step 12/12 [==============================] - loss: 0.7759 - acc: 0.8056 - 881ms/step
    Eval samples: 746
    Epoch 6/10
    step 47/47 [==============================] - loss: 0.5039 - acc: 0.8784 - 986ms/step
    Eval begin...
    The loss value printed in the log is the current batch, and the metric is the average value of previous step.
    step 12/12 [==============================] - loss: 0.7076 - acc: 0.8499 - 884ms/step
    Eval samples: 746
    Epoch 7/10
    step 47/47 [==============================] - loss: 0.4930 - acc: 0.8868 - 972ms/step
    Eval begin...
    The loss value printed in the log is the current batch, and the metric is the average value of previous step.
    step 12/12 [==============================] - loss: 0.2629 - acc: 0.8727 - 878ms/step
    Eval samples: 746
    Epoch 8/10
    step 47/47 [==============================] - loss: 0.2420 - acc: 0.9099 - 989ms/step
    Eval begin...
    The loss value printed in the log is the current batch, and the metric is the average value of previous step.
    step 12/12 [==============================] - loss: 0.3926 - acc: 0.8968 - 879ms/step
    Eval samples: 746
    Epoch 9/10
    step 47/47 [==============================] - loss: 0.2041 - acc: 0.9273 - 982ms/step
    Eval begin...
    The loss value printed in the log is the current batch, and the metric is the average value of previous step.
    step 12/12 [==============================] - loss: 0.7978 - acc: 0.8820 - 885ms/step
    Eval samples: 746
    Epoch 10/10
    step 47/47 [==============================] - loss: 0.0587 - acc: 0.9233 - 976ms/step
    Eval begin...
    The loss value printed in the log is the current batch, and the metric is the average value of previous step.
    step 12/12 [==============================] - loss: 0.1458 - acc: 0.8954 - 879ms/step
    Eval samples: 746
    save checkpoint at /home/aistudio/lup/final



```python
model.evaluate(eval_dataset,verbose=1)
```

    Eval begin...
    The loss value printed in the log is the current batch, and the metric is the average value of previous step.
    step 746/746 [==============================] - loss: 0.1407 - acc: 0.9236 - 59ms/step         
    Eval samples: 746





    {'loss': [0.14068076], 'acc': 0.9235924932975871}



## 7. 应用已经训练好的模型进行预测
# {'loss': [0.14068076], 'acc': 0.9235924932975871}


```python
class InferDataset(Dataset):
    def __init__(self, img_path=None):
        """
        数据读取Reader(推理)
        :param img_path: 推理单张图片
        """
        super().__init__()
        if img_path:
            self.img_paths = [img_path]
        else:
            raise Exception("请指定需要预测对应图片路径")

    def __getitem__(self, index):
        # 获取图像路径
        img_path = self.img_paths[index]
        # 使用Pillow来读取图像数据并转成Numpy格式
        img = Image.open(img_path)
        if img.mode != 'RGB': 
            img = img.convert('RGB') 
        img = preprocess(img) #数据预处理--这里仅包括简单数据预处理，没有用到数据增强
        return img

    def __len__(self):
        return len(self.img_paths)

#实例化推理模型
model = paddle.Model(MyNet(),inputs=input_define)

#读取刚刚训练好的参数
model.load('/home/aistudio/lup/final')

#准备模型
model.prepare()

#得到待预测数据集中每个图像的读取路径
infer_list=[]
with open("/home/aistudio/data/testpath.txt") as file_pred:
    for line in file_pred:
        infer_list.append("/home/aistudio/data/"+line.strip())

#模型预测结果通常是个数，需要获得其对应的文字标签。这里需要建立一个字典。
def get_label_dict2():
    label_list2=[]
    with open("/home/aistudio/data/species.txt") as filess:
        for line in filess:
            a,b = line.strip("\n").split(" ")
            label_list2.append([int(a)-1, b])# [类编号，蝴蝶类名称]
    label_dic2 = dict(label_list2)
    return label_dic2

label_dict2 = get_label_dict2()
#print(label_dict2)

#利用训练好的模型进行预测
results=[]
for infer_path in infer_list:
    infer_data = InferDataset(infer_path)
    result = model.predict(test_data=infer_data)[0] #关键代码，实现预测功能
    result = paddle.to_tensor(result)
    result = np.argmax(result.numpy()) #获得最大值所在的序号
    results.append("{}".format(label_dict2[result])) #查找该序号所对应的标签名字

#把结果保存起来
with open("work/result.txt", "w") as f:
    for r in results:
        f.write("{}\n".format(r))
```

    2021-03-10 13:55:29,321 - INFO - unique_endpoints {''}
    2021-03-10 13:55:29,322 - INFO - File /home/aistudio/.cache/paddle/hapi/weights/resnet101.pdparams md5 checking...
    2021-03-10 13:55:29,924 - INFO - Found /home/aistudio/.cache/paddle/hapi/weights/resnet101.pdparams


    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 69ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 67ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 73ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 76ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 77ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 74ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 67ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 69ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 67ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 67ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 67ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 67ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 66ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 67ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 66ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 69ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 73ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 69ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 75ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 96ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 85ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 69ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 67ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 67ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 66ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 67ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 76ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 76ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 75ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 73ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 66ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 69ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 69ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 69ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 86ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 90ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 92ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 66ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 66ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 64ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 67ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 65ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 64ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 67ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 66ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 65ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 65ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 91ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 99ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 69ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 66ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 76ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 69ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 66ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 69ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 69ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 67ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 69ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 77ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 74ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 73ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 74ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 73ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 74ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 91ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 97ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 91ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 86ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 93ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 84ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 77ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 100ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 110ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 105ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 81ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 80ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 75ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 73ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 75ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 75ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 84ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 74ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 73ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 74ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 73ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 73ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 79ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 97ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 90ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 89ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 69ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 73ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 76ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 74ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 74ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 75ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 98ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 70ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 73ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 77ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 78ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 79ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 77ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 79ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 75ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 76ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 73ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 78ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 79ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 68ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 75ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 73ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 72ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 71ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 74ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 90ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 74ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 74ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 95ms/step
    Predict samples: 1
    Predict begin...
    step 1/1 [==============================] - 103ms/step
    Predict samples: 1

